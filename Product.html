<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <style>
        .product-item img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }
        .product-item h3 {
            font-size: 1.2rem;
            font-weight: bold;
        }
        .product-item p {
            font-size: 0.9rem;
        }
        .category-item {
            cursor: pointer;
            padding: 10px;
            margin: 5px;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        .category-item:hover {
            background-color: #f0f0f0;
        }
        .category-item.active {
            background-color: #007bff;
            color: white;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <a class="navbar-brand" href="index.html">Tohfa</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item">
                    <a class="nav-link" href="index.html">Home</a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="Product.html">Products</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Favourite</a>
                </li>
            </ul>
            <div class="form-inline">
                <a href="Signup.html">
                    <button class="btn btn-outline-light my-2 my-sm-0" type="button">Sign Up</button>
                </a>
            </div>
        </div>
    </nav>
    <main class="container my-4">
        <div class="category d-flex flex-wrap justify-content-center mb-4">
            <div class="category-item" data-category="Same Day Delivery">
                <i class="fas fa-shipping-fast"></i>
                <span>Same Day Delivery</span>
            </div>
            <div class="category-item" data-category="New Arrivals">
                <i class="fas fa-star"></i>
                <span>New Arrivals</span>
            </div>
            <div class="category-item" data-category="Personalized">
                <i class="fas fa-pen"></i>
                <span>Personalized</span>
            </div>
            <div class="category-item" data-category="Flowers / Plants">
                <i class="fas fa-seedling"></i>
                <span>Flowers / Plants</span>
            </div>
            <div class="category-item" data-category="Cakes">
                <i class="fas fa-birthday-cake"></i>
                <span>Cakes</span>
            </div>
            <div class="category-item" data-category="Combos">
                <i class="fas fa-box"></i>
                <span>Combos</span>
            </div>
            <div class="category-item" data-category="Chocolates">
                <i class="fas fa-cookie"></i>
                <span>Chocolates</span>
            </div>
            <div class="category-item" data-category="Festival Offer">
                <i class="fas fa-bullhorn"></i> 
                <span>Festival Offer</span>
            </div>
            <div class="category-item" data-category="Bulk/Corp. Gifts">
                <i class="fas fa-gift"></i>
                <span>Bulk/Corp. Gifts</span>
            </div>
        </div>
        <h2 class="text-center mb-4">Customized any Product</h2>
        <div id="loading-animation" class="text-center mb-4">
            <img src="gift.gif" alt="Loading..." style="width: 100px; height: 100px;">
        </div>
        <div id="product-list" class="row">
            <!-- Product items will be inserted here -->
        </div>
    </main>

    <footer class="bg-dark text-white mt-4">
        <div class="container py-1">
            <div class="row text-center text-md-left">
                <div class="col-md-3 mb-3">
                    <p><strong>Contact Us</strong></p>
                    <ul class="list-unstyled">
                        <li><a href="tel:+919029868797" class="text-white">Phone: (+91) 9029868797</a></li>
                        <li><a href="mailto:shubham.gupta300904@gmail.com" class="text-white">Email: shubham.gupta300904@gmail.com</a></li>
                    </ul>
                </div>
                <div class="col-md-3 mb-3">
                    <p><strong>Policies</strong></p>
                    <ul class="list-unstyled">
                        <li><a href="#" class="text-white">Privacy Policy</a></li>
                        <li><a href="#" class="text-white">Terms of Service</a></li>
                        <li><a href="#" class="text-white">Refund Policy</a></li>
                    </ul>
                </div>
                <div class="col-md-3 mb-3">
                    <p><strong>Quick Links</strong></p>
                    <ul class="list-unstyled">
                        <li><a href="#" class="text-white">Home</a></li>
                        <li><a href="#" class="text-white">Products</a></li>
                        <li><a href="#" class="text-white">Favourite</a></li>
                        <li><a href="#" class="text-white">Contact Us</a></li>
                    </ul>
                </div>
                <div class="col-md-3 mb-3">
                    <p><strong>Follow Us</strong></p>
                    <div class="social-media">
                        <a href="#" class="text-white mr-2"><i class="fab fa-whatsapp fa-lg"></i></a>
                        <a href="#" class="text-white mr-2"><i class="fab fa-facebook fa-lg"></i></a>
                        <a href="#" class="text-white mr-2"><i class="fab fa-twitter fa-lg"></i></a>
                        <a href="#" class="text-white mr-2"><i class="fab fa-instagram fa-lg"></i></a>
                    </div>
                </div>
            </div>
        </div>
        <div class="text-center py-1">
            <p class="mb-0">&copy; 2024 Tohfa. All rights reserved.</p>
        </div>
    </footer>

    <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-firestore.js"></script>
    <script src="script.js"></script>
    <script>
        async function fetchProducts(category = null) {
            const productList = document.getElementById('product-list');
            const loadingAnimation = document.getElementById('loading-animation');
            loadingAnimation.style.display = 'block';
            productList.innerHTML = '';

            try {
                let query = db.collection('products');
                if (category) {
                    query = query.where('categories', 'array-contains', category);
                }
                const querySnapshot = await query.get();

                if (querySnapshot.empty) {
                    productList.innerHTML = '<p class="col-12 text-center">No products found.</p>';
                } else {
                    querySnapshot.forEach((doc) => {
                        const product = doc.data();
                        const productItem = `
                            <div class="col-md-4 mb-4">
                                <div class="card h-100" onclick="redirectToProductDetail('${doc.id}')">
                                    <img src="${product.imageUrl}" class="card-img-top" alt="${product.name}">
                                    <div class="card-body">
                                        <h5 class="card-title">${product.name}</h5>
                                        <p class="card-text">${product.description || ''}</p>
                                        <h3 class="card-text text-primary">â‚¹${product.price}</h3>
                                    </div>
                                </div>
                            </div>
                        `;
                        productList.innerHTML += productItem;
                    });
                }
            } catch (error) {
                console.error('Error fetching products:', error);
                productList.innerHTML = '<p class="col-12 text-center">Error fetching products. Please try again later.</p>';
            } finally {
                loadingAnimation.style.display = 'none';
            }
        }

        function redirectToProductDetail(productId) {
            window.location.href = `ProductDetail.html?id=${productId}`;
        }

        document.querySelectorAll('.category-item').forEach(item => {
            item.addEventListener('click', function () {
                document.querySelectorAll('.category-item').forEach(i => i.classList.remove('active'));
                this.classList.add('active');
                fetchProducts(this.getAttribute('data-category'));
            });
        });

        window.onload = () => {
            fetchProducts();
        };
    </script>
</body>
</html>